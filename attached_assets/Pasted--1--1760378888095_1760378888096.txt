قم بتنفيذ التعديلات التالية بدون تغيير أي جزء آخر من الكود الحالي:

1️⃣ إصلاح الآلة الحاسبة:

أعد تفعيل العمليات الحسابية (+, -, ×, ÷, =, .) التي تم تعطيلها.

اجعل أزرار الأرقام تعمل بشكل طبيعي.

اضبط اتجاه عرض الأرقام في شاشة الآلة الحاسبة ليكون من الشمال إلى اليمين (Left to Right).

لا تغير شكل الواجهة أو اسم الكلاسات.

2️⃣ تحديث سعر السجائر في حسابات المرضى تلقائيًا:

عند تغيير سعر العلبة في صفحة السجائر:

احسب الفرق لكل مريض (عدد الأيام × عدد السجائر × السعر الجديد).

عدّل تلقائيًا قيمة "تكلفة السجائر" و"الإجمالي" و"المتبقي" في جدول المرضى.

قبل تنفيذ التعديل، أظهر نافذة تأكيد للمستخدم فيها:

عدد المرضى المتأثرين.

إجمالي الفرق المالي الناتج عن التحديث.

بعد تأكيد المستخدم:

نفذ التعديل في قاعدة البيانات داخل transaction آمنة.

أضف سجل في جدول audit_log يحتوي على:

المستخدم الذي عدّل.

السعر القديم والجديد.

عدد المرضى الذين تم تحديثهم.

التاريخ والوقت.

3️⃣ إضافة صفحة محرر نصوص متقدمة (Text Editor):

أضف صفحة جديدة داخل البرنامج تسمى "محرر النصوص" تحتوي على:

مربع كتابة (QTextEdit) لكتابة نصوص وتقارير.

أزرار:

حفظ (يحفظ الملف في قاعدة البيانات أو مجلد محلي).

فتح (لاسترجاع الملفات السابقة للتعديل).

طباعة كـ Word (يحفظ النص الحالي كملف .docx).

إدراج جدول (يفتح نافذة لإدخال عدد الصفوف والأعمدة ويُدرج جدولًا في النص يمكن الكتابة فيه مثل Word).

يمكن حفظ أي ملف والعودة إليه لاحقًا وتعديله أو طباعته.

عند الطباعة كـ Word:

الجداول تُحوّل لجداول فعلية داخل الملف باستخدام مكتبة python-docx.

النصوص تحفظ بنفس التنسيق الأساسي.

4️⃣ زر الخروج (Logout):

عند الضغط على زر "خروج" في البرنامج:

أغلق النافذة الحالية أو أخفها.

افتح صفحة تسجيل الدخول (Login Page).

لا تغلق التطبيق بالكامل.

سجّل عملية الخروج في audit_log باسم المستخدم والتاريخ.

5️⃣ صلاحيات المستخدم:

حساب المستخدم (User) العادي يمكنه:

إدخال بيانات جديدة فقط.

ولا يمكنه:

حذف أي صف أو مريض.

تعديل أي بيانات موجودة.

لو حاول الحذف أو التعديل:

يظهر له تنبيه "ليس لديك صلاحية لتعديل أو حذف البيانات".

🧩 ملاحظات تقنية إضافية:

لا تغيّر أي أسماء دوال أو كائنات موجودة.

أضف التعليقات التالية أمام كل تعديل:
# --- FIX / NEW (شرح التعديل) ---

أضف أي مكتبات جديدة فقط إن لزم الأمر (python-docx, beautifulsoup4).

تأكد من أن كل العمليات (حسابات المرضى، السجائر، الآلة الحاسبة، النصوص) تعمل بعد التعديلات بدون أي كراش أو استثناء.

🧠 باختصار:
أصلح الآلة الحاسبة + فعّل تحديث سعر السجائر في حساب المرضى + أضف محرر نصوص متكامل يدعم الجداول والطباعة كورد + زر خروج يرجع لصفحة التسجيل + قفل صلاحيات الحذف والتعديل للمستخدم العادي، بدون لمس أي شيء آخر في المشروع.